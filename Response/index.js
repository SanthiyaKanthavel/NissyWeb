const products = [
    {
        id: 0,
        name: 'Crab Security',
        price: '$30.00',
        image: 'img/Nissy/Newimages/2.jpg',
        category: 'naturalprotienpowder',
        description: 'Lorem ipsum dolor, sit amet consectetur adipisicing elit. Quibusdam odio quidem aliquid voluptatem veritatis maxime eaque voluptatum expedita illo excepturi atque at assumenda quod, delectus ipsa aliquam cupiditate cum tempora.',
        weightOptions: ['1L', '250ml', '500ml'],
        images: ['img/Nissy/Newimages/1.jpg', 'img/Nissy/Newimages/2.jpg', 'img/Nissy/Newimages/5.jpg'],
        weightOptions: ['1L', '250ml', '500ml'],
        availability: "asas of Stock",
        shipping: "01 day shipping. <samp>Free pickup today</samp>",
        weightDetail: "0.5 kg",
        rate: "$400.00",
        productImage: [
            "img/product/details/product-details-1.jpg",
            "img/product/details/thumb-1.jpg",
            "img/product/details/thumb-2.jpg",
            "img/product/details/thumb-3.jpg",
            "img/product/details/thumb-4.jpg"
        ],
        weights: [
            { id: "weight1", value: "1KG", label: "1KG" },
            { id: "weight2", value: "250GM", label: "250GM" },
            { id: "weight3", value: "500GM", label: "500GM" }
        ],
    },
    {
        id: 1,
        name: 'Crab Pool Security',
        price: '$30.00',
        image: 'img/Nissy/Newimages/2.jpg',
        category: 'naturalprotienpowder',
        description: 'Lorem ipsum dolor, sit amet consectetur adipisicing elit. Quibusdam odio quidem aliquid voluptatem veritatis maxime eaque voluptatum expedita illo excepturi atque at assumenda quod, delectus ipsa aliquam cupiditate cum tempora.',
        weightOptions: ['1L', '250ml', '500ml'],
        images: ['img/Nissy/Newimages/1.jpg', 'img/Nissy/Newimages/2.jpg', 'img/Nissy/Newimages/5.jpg'],
        weightOptions: ['1L', '250ml', '500ml'],
        availability: "lusu of Stock",
        shipping: "01 day shipping. <samp>Free pickup today</samp>",
        weightDetail: "0.5 kg",
        rate: "$400.00",
        productImage: [
            "img/product/details/product-details-1.jpg",
            "img/product/details/thumb-1.jpg",
            "img/product/details/thumb-2.jpg",
            "img/product/details/thumb-3.jpg",
            "img/product/details/thumb-4.jpg"
        ],
        weights: [
            { id: "weight1", value: "1KG", label: "1KG" },
            { id: "weight2", value: "250GM", label: "250GM" },
            { id: "weight3", value: "500GM", label: "500GM" }
        ],
    },
    {
        id: 2,
        name: 'Crab Pool Security',
        price: '$30.00',
        image: 'img/Nissy/Newimages/2.jpg',
        category: 'naturalprotienpowder',
        description: 'Lorem ipsum dolor, sit amet consectetur adipisicing elit. Quibusdam odio quidem aliquid voluptatem veritatis maxime eaque voluptatum expedita illo excepturi atque at assumenda quod, delectus ipsa aliquam cupiditate cum tempora.',
        weightOptions: ['1L', '250ml', '500ml'],
        images: ['img/Nissy/Newimages/1.jpg', 'img/Nissy/Newimages/2.jpg', 'img/Nissy/Newimages/5.jpg'],
        weightOptions: ['1L', '250ml', '500ml'],
        availability: "wsdsa of Stock",
        shipping: "01 day shipping. <samp>Free pickup today</samp>",
        weightDetail: "0.5 kg",
        rate: "$400.00",
        productImage: [
            "img/product/details/product-details-1.jpg",
            "img/product/details/thumb-1.jpg",
            "img/product/details/thumb-2.jpg",
            "img/product/details/thumb-3.jpg",
            "img/product/details/thumb-4.jpg"
        ],
        weights: [
            { id: "weight1", value: "1KG", label: "1KG" },
            { id: "weight2", value: "250GM", label: "250GM" },
            { id: "weight3", value: "500GM", label: "500GM" }
        ],
    },
    {
        id: 3,
        name: 'Crab Pool Security',
        price: '$30.00',
        image: 'img/Nissy/Newimages/4.jpg',
        category: 'Malt',
        description: 'Lorem ipsum dolor, sit amet consectetur adipisicing elit. Quibusdam odio quidem aliquid voluptatem veritatis maxime eaque voluptatum expedita illo excepturi atque at assumenda quod, delectus ipsa aliquam cupiditate cum tempora.',
        weightOptions: ['1L', '250ml', '500ml'],
        images: ['img/Nissy/Newimages/3.jpg', 'img/Nissy/Newimages/6.jpg'],
        weightOptions: ['1L', '250ml', '500ml'],
        images: ['img/Nissy/Newimages/1.jpg', 'img/Nissy/Newimages/2.jpg', 'img/Nissy/Newimages/5.jpg'],
        weightOptions: ['1L', '250ml', '500ml'],
        availability: "out od Stock",
        shipping: "01 day shipping. <samp>Free pickup today</samp>",
        weightDetail: "0.5 kg",
        rate: "$400.00",
        productImage: [
            "img/product/details/product-details-1.jpg",
            "img/product/details/thumb-1.jpg",
            "img/product/details/thumb-2.jpg",
            "img/product/details/thumb-3.jpg",
            "img/product/details/thumb-4.jpg"
        ],
        weights: [
            { id: "weight1", value: "1KG", label: "1KG" },
            { id: "weight2", value: "250GM", label: "250GM" },
            { id: "weight3", value: "500GM", label: "500GM" }
        ],
    },
    {
        id: 4,
        name: 'Crab Pool Security',
        price: '$30.00',
        image: 'img/Nissy/Newimages/5.jpg',
        category: 'Malt',
        description: 'Lorem ipsum dolor, sit amet consectetur adipisicing elit. Quibusdam odio quidem aliquid voluptatem veritatis maxime eaque voluptatum expedita illo excepturi atque at assumenda quod, delectus ipsa aliquam cupiditate cum tempora.',
        weightOptions: ['1L', '250ml', '500ml'],
        images: ['img/Nissy/Newimages/3.jpg', 'img/Nissy/Newimages/6.jpg'],
        weightOptions: ['1L', '250ml', '500ml'],
        images: ['img/Nissy/Newimages/1.jpg', 'img/Nissy/Newimages/2.jpg', 'img/Nissy/Newimages/5.jpg'],
        weightOptions: ['1L', '250ml', '500ml'],
        availability: "In of Stock",
        shipping: "01 day shipping. <samp>Free pickup today</samp>",
        weightDetail: "0.5 kg",
        rate: "$400.00",
        productImage: [
            "img/product/details/product-details-1.jpg",
            "img/product/details/thumb-1.jpg",
            "img/product/details/thumb-2.jpg",
            "img/product/details/thumb-3.jpg",
            "img/product/details/thumb-4.jpg"
        ],
        weights: [
            { id: "weight1", value: "1KG", label: "1KG" },
            { id: "weight2", value: "250GM", label: "250GM" },
            { id: "weight3", value: "500GM", label: "500GM" }
        ],
    },
    {
        id: 5,
        name: 'Crab Pool Security',
        price: '$30.00',
        image: 'img/Nissy/Newimages/6.jpg',
        category: 'babyfood',
        description: 'Lorem ipsum dolor, sit amet consectetur adipisicing elit. Quibusdam odio quidem aliquid voluptatem veritatis maxime eaque voluptatum expedita illo excepturi atque at assumenda quod, delectus ipsa aliquam cupiditate cum tempora.',
        weightOptions: ['1L', '250ml', '500ml'],
        images: ['img/Nissy/Newimages/3.jpg', 'img/Nissy/Newimages/6.jpg'],
        weightOptions: ['1L', '250ml', '500ml'],
        images: ['img/Nissy/Newimages/1.jpg', 'img/Nissy/Newimages/2.jpg', 'img/Nissy/Newimages/5.jpg'],
        weightOptions: ['1L', '250ml', '500ml'],
        availability: "In Stock",
        shipping: "01 day shipping. <samp>Free pickup today</samp>",
        weightDetail: "0.5 kg",
        rate: "$400.00",
        productImage: [
            "img/product/details/product-details-1.jpg",
            "img/product/details/thumb-1.jpg",
            "img/product/details/thumb-2.jpg",
            "img/product/details/thumb-3.jpg",
            "img/product/details/thumb-4.jpg"
        ],
        weights: [
            { id: "weight1", value: "1KG", label: "1KG" },
            { id: "weight2", value: "250GM", label: "250GM" },
            { id: "weight3", value: "500GM", label: "500GM" }
        ],
    },
    {
        id: 6,
        name: 'Crab Pool Security',
        price: '$30.00',
        image: 'img/Nissy/Newimages/7.jpg',
        category: 'babyfood',
        description: 'Lorem ipsum dolor, sit amet consectetur adipisicing elit. Quibusdam odio quidem aliquid voluptatem veritatis maxime eaque voluptatum expedita illo excepturi atque at assumenda quod, delectus ipsa aliquam cupiditate cum tempora.',
        weightOptions: ['1L', '250ml', '500ml'],
        images: ['img/Nissy/Newimages/3.jpg', 'img/Nissy/Newimages/6.jpg'],
        weightOptions: ['1L', '250ml', '500ml'],
        images: ['img/Nissy/Newimages/1.jpg', 'img/Nissy/Newimages/2.jpg', 'img/Nissy/Newimages/5.jpg'],
        weightOptions: ['1L', '250ml', '500ml'],
        availability: "In Stock",
        shipping: "01 day shipping. <samp>Free pickup today</samp>",
        weightDetail: "0.5 kg",
        rate: "$400.00",
        productImage: [
            "img/product/details/product-details-1.jpg",
            "img/product/details/thumb-1.jpg",
            "img/product/details/thumb-2.jpg",
            "img/product/details/thumb-3.jpg",
            "img/product/details/thumb-4.jpg"
        ],
        weights: [
            { id: "weight1", value: "1KG", label: "1KG" },
            { id: "weight2", value: "250GM", label: "250GM" },
            { id: "weight3", value: "500GM", label: "500GM" }
        ],
    },
    {
        id: 7,
        name: 'Crab Pool Security',
        price: '$30.00',
        image: 'img/Nissy/Newimages/8.jpg',
        category: 'skincare',
        description: 'Lorem ipsum dolor, sit amet consectetur adipisicing elit. Quibusdam odio quidem aliquid voluptatem veritatis maxime eaque voluptatum expedita illo excepturi atque at assumenda quod, delectus ipsa aliquam cupiditate cum tempora.',
        weightOptions: ['1L', '250ml', '500ml'],
        images: ['img/Nissy/Newimages/3.jpg', 'img/Nissy/Newimages/6.jpg'],
        weightOptions: ['1L', '250ml', '500ml'],
        images: ['img/Nissy/Newimages/1.jpg', 'img/Nissy/Newimages/2.jpg', 'img/Nissy/Newimages/5.jpg'],
        weightOptions: ['1L', '250ml', '500ml'],
        availability: "Out of Stock",
        shipping: "01 day shipping. <samp>Free pickup today</samp>",
        weightDetail: "0.5 kg",
        rate: "$400.00",
        productImage: [
            "img/product/details/product-details-1.jpg",
            "img/product/details/thumb-1.jpg",
            "img/product/details/thumb-2.jpg",
            "img/product/details/thumb-3.jpg",
            "img/product/details/thumb-4.jpg"
        ],
        weights: [
            { id: "weight1", value: "1KG", label: "1KG" },
            { id: "weight2", value: "250GM", label: "250GM" },
            { id: "weight3", value: "500GM", label: "500GM" }
        ],
    },
    {
        id: 8,
        name: 'Crab Pool Security',
        price: '$30.00',
        image: 'img/Nissy/Newimages/9.jpg',
        category: 'skincare',
        description: 'Lorem ipsum dolor, sit amet consectetur adipisicing elit. Quibusdam odio quidem aliquid voluptatem veritatis maxime eaque voluptatum expedita illo excepturi atque at assumenda quod, delectus ipsa aliquam cupiditate cum tempora.',
        weightOptions: ['1L', '250ml', '500ml'],
        images: ['img/Nissy/Newimages/3.jpg', 'img/Nissy/Newimages/6.jpg'],
        weightOptions: ['1L', '250ml', '500ml'],
        images: ['img/Nissy/Newimages/1.jpg', 'img/Nissy/Newimages/2.jpg', 'img/Nissy/Newimages/5.jpg'],
        weightOptions: ['1L', '250ml', '500ml'],
        availability: "In Stock",
        shipping: "01 day shipping. <samp>Free pickup today</samp>",
        weightDetail: "0.5 kg",
        rate: "$400.00",
        productImage: [
            "img/product/details/product-details-1.jpg",
            "img/product/details/thumb-1.jpg",
            "img/product/details/thumb-2.jpg",
            "img/product/details/thumb-3.jpg",
            "img/product/details/thumb-4.jpg"
        ],
        weights: [
            { id: "weight1", value: "1KG", label: "1KG" },
            { id: "weight2", value: "250GM", label: "250GM" },
            { id: "weight3", value: "500GM", label: "500GM" }
        ],
    },
    {
        id: 9,
        name: 'Crab Pool Security',
        price: '$30.00',
        image: 'img/Nissy/Newimages/10.jpg',
        category: 'skincare',
        description: 'Lorem ipsum dolor, sit amet consectetur adipisicing elit. Quibusdam odio quidem aliquid voluptatem veritatis maxime eaque voluptatum expedita illo excepturi atque at assumenda quod, delectus ipsa aliquam cupiditate cum tempora.',
        weightOptions: ['1L', '250ml', '500ml'],
        images: ['img/Nissy/Newimages/3.jpg', 'img/Nissy/Newimages/6.jpg'],
        weightOptions: ['1L', '250ml', '500ml'],
        images: ['img/Nissy/Newimages/1.jpg', 'img/Nissy/Newimages/2.jpg', 'img/Nissy/Newimages/5.jpg'],
        weightOptions: ['1L', '250ml', '500ml'],
        availability: "In Stock",
        shipping: "01 day shipping. <samp>Free pickup today</samp>",
        weightDetail: "0.5 kg",
        rate: "$400.00",
        productImage: [
            "img/product/details/product-details-1.jpg",
            "img/product/details/thumb-1.jpg",
            "img/product/details/thumb-2.jpg",
            "img/product/details/thumb-3.jpg",
            "img/product/details/thumb-4.jpg"
        ],
        weights: [
            { id: "weight1", value: "1KG", label: "1KG" },
            { id: "weight2", value: "250GM", label: "250GM" },
            { id: "weight3", value: "500GM", label: "500GM" }
        ],
    },
    // Add more products as needed
];

function generateProductHTML(product) {
    const weightOptionsHTML = product.weightOptions.map(weight =>
        `<label><input type="radio" name="weight-${product.id}" value="${weight}"> ${weight}</label><br>`).join('');

    const imagesHTML = product.images.map(img =>
        `<img src="${img}" alt="image">`).join('');

    return `
                <div class="featured__filter-items col-lg-3 col-md-4 col-sm-6 mix ${product.category}">
                    <div class="featured__item">
                        <div class="featured__item__pic set-bg" onclick="location.href='shop-details.html?id=${product.id}'" style="background-image: url(${product.image});"> 
                            <ul class="featured__item__pic__hover">
                                <li><a href="#" onclick="toggleFavorite(${product.id})"><i class="fa fa-heart"></i></a></li>
                            <li><a href="#" onclick="addToCart(${product.id})"><i class="fa fa-shopping-cart"></i></a></li>
                            </ul>
                       </div>
                        <div class="featured__item__text">
                            <h6><a href="#">${product.name}</a></h6>
                            <h5>${product.price}</h5>
                            <button class="featured__item__text-optionbtn" onclick="openNav(${product.id})">Select Option</button>
                            <div id="overlay-${product.id}" class="overlay" onclick="closeNav(${product.id})"></div>
                            <div id="mySidenav-${product.id}" class="sidenav">
                                <a href="javascript:void(0)" class="closebtn" onclick="closeNav(${product.id})">&times;</a>
                                <div class="sidenav-content">
                                    <div class="slider" id="slider-${product.id}">
                                        <div class="slides" id="slides-${product.id}">
                                            ${imagesHTML}
                                        </div>
                                        <button class="prev" onclick="moveSlide(${product.id}, -1)">&#10094;</button>
                                        <button class="next" onclick="moveSlide(${product.id}, 1)">&#10095;</button>
                                    </div>
                                    <div class="main-content">
                                        <div class="main-content-heading"><a>${product.name}</a></div>
                                        <p>${product.price}</p>
                                        <p>${product.description}</p>
                                        <div>
                                            <h4>Weight</h4>
                                            <div class="weight-display">
                                                ${weightOptionsHTML}
                                            </div>
                                        </div>
                                        <div class="order-section">
                                            <button class="order-section-countbutton" onclick="changeQuantity(-1, ${product.id})">-</button>
                                            <span id="quantity-${product.id}">1</span>
                                            <button class="order-section-countbutton" onclick="changeQuantity(1, ${product.id})">+</button>
                                            <button class="add-to-cart">Add to Cart</button>
                                            <button class="buy-now">Buy Now</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`;
}

function renderProducts(products) {
    const container = document.querySelector('.featured__filter');
    container.innerHTML = products.map(generateProductHTML).join('');
}

$(document).ready(function () {
    renderProducts(products);
    updateFavoriteCount();
    loadFavorites();
    updateCartCount();
});
document.addEventListener('DOMContentLoaded', function () {
    const cartCount = localStorage.getItem('cartCount') || 0;
    document.querySelector('.fa-shopping-bag + span').textContent = cartCount;

    const favoriteCount = localStorage.getItem('favoriteCount') || 0;
    document.querySelector('.fa-heart + span').textContent = favoriteCount;

    updateCartCount();
    updateFavoriteCount();
});

function openNav(id) {
    document.getElementById(`mySidenav-${id}`).style.width = "400px";
    document.getElementById(`overlay-${id}`).style.display = "block";
    currentIndex[id] = 0;
    showSlides(id);
}
function addToCart(productId) {
    const product = products.find(p => p.id === productId);
    let cart = JSON.parse(localStorage.getItem('cart')) || [];

    const existingProductIndex = cart.findIndex(item => item.id === product.id);
    if (existingProductIndex !== -1) {
        cart.splice(existingProductIndex, 1);
    } else {
        cart.push({ ...product, quantity: 1 });
    }

    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartCount();
}

function updateCartCount() {
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    const totalCount = cart.reduce((total, item) => total + item.quantity, 0);
    document.querySelector('.fa-shopping-bag + span').textContent = totalCount;
    localStorage.setItem('cartCount', totalCount);
}

function closeNav(id) {
    document.getElementById(`mySidenav-${id}`).style.width = "0";
    document.getElementById(`overlay-${id}`).style.display = "none";
}

function changeQuantity(amount, id) {
    const quantityElement = document.getElementById(`quantity-${id}`);
    let quantity = parseInt(quantityElement.textContent);
    quantity = Math.max(1, quantity + amount);
    quantityElement.textContent = quantity;
}

let currentIndex = {};

function moveSlide(id, n) {
    currentIndex[id] += n;
    showSlides(id);
}

function showSlides(id) {
    const slides = document.querySelectorAll(`#slider-${id} .slides img`);
    if (currentIndex[id] >= slides.length) {
        currentIndex[id] = 0;
    }
    if (currentIndex[id] < 0) {
        currentIndex[id] = slides.length - 1;
    }
    slides.forEach((slide, index) => {
        slide.style.display = index === currentIndex[id] ? 'block' : 'none';
    });
}

function toggleFavorite(productId) {
    let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
    if (favorites.includes(productId)) {
        favorites = favorites.filter(id => id !== productId);
    } else {
        favorites.push(productId);
    }
    localStorage.setItem('favorites', JSON.stringify(favorites));
    updateFavoriteCount();
    loadFavorites();
}

function updateFavoriteCount() {
    const favorites = JSON.parse(localStorage.getItem('favorites')) || [];
    document.getElementById('favorite-count').textContent = favorites.length;
    // localStorage.setItem('favoriteCount', favoriteCount);
}


function loadFavorites() {
    const favorites = JSON.parse(localStorage.getItem('favorites')) || [];
    const favoritesList = document.getElementById('favoritesList');
    favoritesList.innerHTML = '';

    favorites.forEach(id => {
        const product = products.find(p => p.id === id);
        if (product) {
            favoritesList.innerHTML += `
                <div class="favorite-item">
                    <h4>${product.name}</h4>
                    <p>${product.price}</p>
                    <p>${product.description}</p>
                    <button onclick="removeFavorite(${id})">Remove</button>
                </div>
            `;
        }
    });
}

function removeFavorite(productId) {
    let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
    favorites = favorites.filter(id => id !== productId);
    localStorage.setItem('favorites', JSON.stringify(favorites));
    updateFavoriteCount();
    loadFavorites();
}

function showFavoritesPopup() {
    const popup = document.getElementById('favoritesPopup');
    popup.style.display = 'block';
    loadFavorites();
}

function closeFavoritesPopup() {
    const popup = document.getElementById('favoritesPopup');
    popup.style.display = 'none';
}